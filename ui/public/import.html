<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport"
		content="width=device-width, initial-scale=1.0">
	<title>E.T.L - Extract Transform Load</title>
	<link rel="stylesheet"
		href="style.css">
	<!-- Dropzone -->
	<link rel="stylesheet"
		href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css" />
	<script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script>
</head>

<body>
	<div class="container">
		<!-- Header -->
		<header class="header">
			<h1 class="logo">
				<span class="logo-icon"
					id="cute-icon">
				</span>
				<span id="cute-acro">E.T.L</span>
				<span id="cute-description">Extract Transform Load</span>
			</h1>
			<p class="subtitle">stream data to mixpanel with powerful transforms</p>
		</header>

		<!-- Main Form -->
		<form id="importForm"
			class="import-form">
			<!-- File Upload Section -->
			<section class="card">
				<h2 class="section-title">📁 Data Files</h2>
				<p class="section-description">Choose between local files or cloud storage. Supports JSON, JSONL, CSV,
					and Parquet formats.</p>

				<!-- File Source Toggle -->
				<div class="file-source-toggle">
					<label class="toggle-label">
						<input type="radio"
							name="fileSource"
							value="local"
							checked>
						💻 Local Files (Drag & Drop)
					</label>
					<label class="toggle-label">
						<input type="radio"
							name="fileSource"
							value="gcs">
						☁️ Google Cloud (gs://)
					</label>
					<label class="toggle-label">
						<input type="radio"
							name="fileSource"
							value="s3">
						☁️ Amazon S3 (s3://)
					</label>
				</div>

				<!-- Local File Upload -->
				<div id="local-upload"
					class="upload-section">
					<div id="file-dropzone"
						class="dropzone-custom">
						<div class="dropzone-message">
							<span class="dropzone-icon">⬆️</span>
							<p>Drop files here or click to browse</p>
							<small>JSON, JSONL, CSV, Parquet supported</small>
						</div>
					</div>
					<div id="file-list"
						class="file-list"></div>
				</div>

				<!-- GCS File Input -->
				<div id="gcs-upload"
					class="upload-section"
					style="display: none;">
					<div class="form-group">
						<label for="gcsPaths">Google Cloud Storage Paths</label>
						<textarea id="gcsPaths"
							name="gcsPaths"
							rows="4"
							placeholder="gs://your-bucket/path/to/file.json&#10;gs://your-bucket/path/to/another-file.jsonl&#10;gs://your-bucket/data/events.parquet.gz"
							autocomplete="off"></textarea>
						<small>Enter Google Cloud Storage paths (one per line or comma-separated). Must start with gs://</small>
					</div>
					<div id="gcs-file-list"
						class="cloud-file-preview"></div>
				</div>

				<!-- S3 File Input -->
				<div id="s3-upload"
					class="upload-section"
					style="display: none;">
					<div class="form-group">
						<label for="s3Paths">Amazon S3 Storage Paths</label>
						<textarea id="s3Paths"
							name="s3Paths"
							rows="4"
							placeholder="s3://your-bucket/path/to/file.json&#10;s3://your-bucket/path/to/another-file.jsonl&#10;s3://your-bucket/data/events.parquet.gz"
							autocomplete="off"></textarea>
						<small>Enter Amazon S3 paths (one per line or comma-separated). Must start with s3://</small>
					</div>
					<div id="s3-file-list"
						class="cloud-file-preview"></div>
				</div>

				<!-- Preview Data Section -->
				<div class="preview-actions" style="margin-top: 20px; text-align: center;">
					<button type="button" id="preview-data-btn" class="btn btn-ghost">
						<span class="btn-icon">👁️</span>
						Preview Data (Raw)
					</button>
				</div>

				<!-- Data Preview Display -->
				<div id="data-preview" class="preview-section" style="display: none; margin-top: 20px;">
					<h3>Raw Data Preview</h3>
					<p class="section-description">This shows your data as it appears before any transforms or processing.</p>
					<div id="preview-content" class="results-data"></div>
					<div class="preview-actions" style="margin-top: 16px; text-align: center;">
						<button type="button" id="see-more-btn" class="btn btn-secondary btn-sm">
							<span class="btn-icon">🔄</span>
							See More Records
						</button>
					</div>
				</div>
			</section>

			<!-- Column Mapper Section -->
			<section class="card" id="column-mapper-section" style="display: none;">
				<h2 class="section-title">🔗 Column Mapping (Optional)</h2>
				<p class="section-description">Map your data columns to common Mixpanel fields. This creates simple column renaming aliases for you.</p>
				
				<div class="column-mapper-actions">
					<button type="button" id="detect-columns-btn" class="btn btn-secondary">
						<span class="btn-icon">🔍</span>
						Detect Columns from Data
					</button>
				</div>

				<div id="column-mapper-content" style="display: none;">
					<div class="column-mapper-grid">
						<!-- Mixpanel field mappings will be populated here -->
					</div>
					
					<div class="column-mapper-status">
						<p id="mapper-status" class="section-description"></p>
					</div>
				</div>
			</section>

			<!-- Record Type Selection -->
			<section class="card">
				<h2 class="section-title">📋 Type of Import</h2>
				<p class="section-description">Select what type of data you're importing to show the correct
					authentication options.</p>

				<div class="form-group">
					<label for="recordType">Import Type*</label>
					<select id="recordType"
						name="recordType"
						required>
						<option value="">Select import type...</option>
						<option value="event">🎯 Events</option>
						<option value="user">👤 User Profiles</option>
						<option value="group">👥 Group Profiles</option>
						<option value="table">📋 Lookup Tables</option>
					</select>
					<small>Different import types require different authentication settings</small>
				</div>
			</section>

			<!-- Credentials Section -->
			<section class="card"
				id="credentials-section"
				style="display: none;">
				<h2 class="section-title">🔑 Mixpanel Credentials</h2>
				<p class="section-description"
					id="credentials-description">Select an import type above to see the required authentication
					settings.</p>

				<div class="form-group"
					id="project-group"
					style="display: none;">
					<label for="project">Project ID*</label>
					<input type="text"
						id="project"
						name="project"
						placeholder="Your project ID"
						autocomplete="off">
					<small>Found in your Mixpanel project settings</small>
				</div>

				<div class="form-group"
					id="lookupTableId-group"
					style="display: none;">
					<label for="lookupTableId">Lookup Table ID*</label>
					<input type="text"
						id="lookupTableId"
						name="lookupTableId"
						placeholder="Your lookup table ID"
						autocomplete="off">
					<small>ID of the lookup table to import into</small>
				</div>

				<!-- Auth Method Toggle -->
				<div class="auth-toggle"
					id="auth-toggle"
					style="display: none;">
					<label class="toggle-label">
						<input type="radio"
							name="authMethod"
							value="service"
							checked>
						Service Account (Recommended)
					</label>
					<label class="toggle-label">
						<input type="radio"
							name="authMethod"
							value="secret">
						API Secret (Legacy)
					</label>
				</div>

				<!-- Service Account Fields -->
				<div id="service-auth"
					class="auth-section"
					style="display: none;">
					<div class="form-row">
						<div class="form-group">
							<label for="acct">Account Username*</label>
							<input type="text"
								id="acct"
								name="acct"
								placeholder="service-account@yourorg.com">
						</div>
						<div class="form-group">
							<label for="pass">Account Password*</label>
							<input type="password"
								id="pass"
								name="pass"
								placeholder="Your service account password">
						</div>
					</div>
				</div>

				<!-- API Secret Fields -->
				<div id="secret-auth"
					class="auth-section"
					style="display: none;">
					<div class="form-group">
						<label for="secret">API Secret*</label>
						<input type="password"
							id="secret"
							name="secret"
							placeholder="Your project's API secret">
						<small>Legacy authentication method</small>
					</div>
				</div>

				<!-- Additional Tokens -->
				<div class="form-group"
					id="token-group"
					style="display: none;">
					<label for="token">Project Token*</label>
					<input type="text"
						id="token"
						name="token"
						placeholder="Your project token"
						autocomplete="off">
					<small>Required for user/group profiles</small>
				</div>

				<div class="form-group"
					id="groupKey-group"
					style="display: none;">
					<label for="groupKey">Group Key*</label>
					<input type="text"
						id="groupKey"
						name="groupKey"
						placeholder="Your group analytics key"
						autocomplete="off">
					<small>Required for group profile imports</small>
				</div>

				<!-- S3 Credentials -->
				<div class="s3-credentials"
					id="s3-credentials"
					style="display: none;">
					<h3 class="subsection-title">Amazon S3 Credentials</h3>
					<div class="form-row">
						<div class="form-group">
							<label for="s3Key">S3 Access Key*</label>
							<input type="text"
								id="s3Key"
								name="s3Key"
								placeholder="Your AWS access key ID"
								autocomplete="off">
						</div>
						<div class="form-group">
							<label for="s3Secret">S3 Secret Key*</label>
							<input type="password"
								id="s3Secret"
								name="s3Secret"
								placeholder="Your AWS secret access key">
						</div>
					</div>
					<div class="form-group">
						<label for="s3Region">S3 Region*</label>
						<input type="text"
							id="s3Region"
							name="s3Region"
							placeholder="us-east-1"
							autocomplete="off">
						<small>AWS region where your S3 bucket is located (e.g., us-east-1, eu-west-1)</small>
					</div>
				</div>

				<!-- Optional Fields -->

			</section>

			<!-- Configuration Section -->
			<section class="card">
				<h2 class="section-title">⚙️ Import Configuration</h2>
				<p class="section-description">Fine-tune your import settings for optimal performance and data quality.
				</p>

				<!-- Core Settings -->
				<div class="config-section">
					<h3 class="subsection-title">Core Settings</h3>
					<div class="form-row">
						<div class="form-group">
							<label for="workers"
								title="Higher values import faster but may hit rate limits. Start with 10 and increase if your network can handle more concurrent requests">Concurrency
								Workers</label>
							<input type="number"
								id="workers"
								name="workers"
								value="10"
								min="1"
								max="50"
								autocomplete="off">
							<small>Number of concurrent HTTP requests (default: 10)</small>
						</div>
						<div class="form-group">
							<label for="recordsPerBatch">Records per Batch</label>
							<input type="number"
								id="recordsPerBatch"
								name="recordsPerBatch"
								value="2000"
								min="1"
								max="5000"
								autocomplete="off">
							<small>Records per API request (default: 2000)</small>
						</div>
					</div>

					<div class="form-row">
						<div class="form-group">
							<label for="region">Data Residency</label>
							<select id="region"
								name="region">
								<option value="US">🇺🇸 United States</option>
								<option value="EU">🇪🇺 European Union</option>
								<option value="IN">🇮🇳 India</option>
							</select>
							<small>Your Mixpanel data residency region</small>
						</div>
						<div class="form-group">
							<label for="vendor">Vendor Transform</label>
							<select id="vendor"
								name="vendor">
								<option value="">None (Native format)</option>
								<option value="mixpanel">Mixpanel</option>
								<option value="amplitude">Amplitude</option>
								<option value="heap">Heap Analytics</option>
								<option value="ga4">Google Analytics 4</option>
								<option value="june">June.so</option>
								<option value="adobe">Adobe Analytics</option>
								<option value="pendo">Pendo</option>
								<option value="mparticle">mParticle</option>
								<option value="posthog">PostHog</option>
							</select>
							<small>Transform data from other analytics platforms</small>
						</div>
					</div>
				</div>

				<!-- Expand/Collapse All Button -->
				<div class="section-controls">
					<button type="button" id="toggle-all-btn" class="btn btn-ghost btn-sm" onclick="toggleAllSections()">
						<span class="btn-icon">📂</span>
						<span id="toggle-all-text">Expand All</span>
					</button>
				</div>

				<!-- Performance & Processing -->
				<div class="collapsible-section">
					<div class="section-header"
						onclick="toggleSection('performance-section')"
						title="Configure request batching, compression, HTTP transport, and other performance settings">
						<span class="section-icon">📈</span>
						<h3>Performance & Processing</h3>
						<span class="toggle-icon">▼</span>
					</div>
					<div id="performance-section"
						class="collapsible-content"
						style="display: none;">
						<div class="form-row">
							<div class="form-group">
								<label for="bytesPerBatch">Bytes per Batch</label>
								<input type="number"
									id="bytesPerBatch"
									name="bytesPerBatch"
									value="2000000"
									min="1000"
									max="2000000"
									autocomplete="off">
								<small>Max bytes per API request (default: 2MB)</small>
							</div>
							<div class="form-group">
								<label for="maxRetries">Max Retries</label>
								<input type="number"
									id="maxRetries"
									name="maxRetries"
									value="10"
									min="0"
									max="50"
									autocomplete="off">
								<small>Maximum retry attempts on failures (default: 10)</small>
							</div>
						</div>

						<div class="form-row">
							<div class="form-group">
								<label for="streamFormat">File Format</label>
								<select id="streamFormat"
									name="streamFormat">
									<option value="">Auto-detect from file extension</option>
									<option value="jsonl">JSONL (recommended)</option>
									<option value="json">JSON</option>
									<option value="csv">CSV</option>
									<option value="parquet">Parquet</option>
								</select>
								<small>Format of underlying data stream</small>
							</div>
							<div class="form-group">
								<label for="transport">HTTP Transport</label>
								<select id="transport"
									name="transport">
									<option value="got">Got (default)</option>
									<option value="undici">Undici</option>
								</select>
								<small>HTTP client for sending requests</small>
							</div>
						</div>

						<div class="form-row">
							<div class="form-group checkbox-group">
								<label class="checkbox-label">
									<input type="checkbox"
										id="compress"
										name="compress">
									Enable Compression
								</label>
								<small>Gzip compress requests (events only)</small>
							</div>
							<div class="form-group">
								<label for="compressionLevel">Compression Level</label>
								<input type="range"
									id="compressionLevel"
									name="compressionLevel"
									min="0"
									max="9"
									value="6"
									autocomplete="off">
								<small>0 = none, 9 = max compression (default: 6)</small>
							</div>
						</div>
					</div>
				</div>

				<!-- Data Processing -->
				<div class="collapsible-section">
					<div class="section-header"
						onclick="toggleSection('data-processing-section')"
						title="Enable data cleaning, validation, timestamp conversion, and other data transformations">
						<span class="section-icon">🔄</span>
						<h3>Data Processing</h3>
						<span class="toggle-icon">▼</span>
					</div>
					<div id="data-processing-section"
						class="collapsible-content"
						style="display: none;">
						<div class="processing-options">
							<div class="processing-option">
								<label class="checkbox-label">
									<input type="checkbox"
										id="fixData"
										name="fixData"
										checked>
									Auto-Fix Data Shape & Issues
								</label>
								<div class="example">
									<code>{"name": "John", "age": 30}</code> →
									<code>{"event": "...", "properties": {"name": "John", "age": 30}}</code>
									<small>Ensures proper Mixpanel event structure, converts IDs to strings, adds
										$insert_id</small>
								</div>
							</div>

							<div class="processing-option">
								<label class="checkbox-label">
									<input type="checkbox"
										id="fixTime"
										name="fixTime">
									Convert Timestamps to Unix
								</label>
								<div class="example">
									<code>{"time": "2025-08-09T15:25:00Z"}</code> → <code>{"time": 1754767500}</code>
									<small>Converts ISO dates and other formats to Unix epoch milliseconds</small>
								</div>
							</div>

							<div class="processing-option">
								<label class="checkbox-label">
									<input type="checkbox"
										id="strict"
										name="strict">
									Strict Validation
								</label>
								<div class="example">
									<code>{"event": ""}</code> → <span class="error-text">❌ Rejected</span>
									<small>Fail fast on validation errors (empty events, missing required
										fields)</small>
								</div>
							</div>

							<div class="processing-option">
								<label class="checkbox-label">
									<input type="checkbox"
										id="removeNulls"
										name="removeNulls">
									Remove Empty Values
								</label>
								<div class="example">
									<code>{"name": "John", "email": null, "tags": []}</code> →
									<code>{"name": "John"}</code>
									<small>Removes null values, empty strings, empty arrays/objects from
										properties</small>
								</div>
							</div>

							<div class="processing-option">
								<label class="checkbox-label">
									<input type="checkbox"
										id="flattenData"
										name="flattenData">
									Flatten Nested Properties
								</label>
								<div class="example">
									<code>{"user": {"plan": "pro"}}</code> → <code>{"user.plan": "pro"}</code>
									<small>Flattens nested objects in properties using dot notation (configurable
										separator)</small>
								</div>
							</div>

							<div class="processing-option">
								<label class="checkbox-label">
									<input type="checkbox"
										id="fixJson"
										name="fixJson">
									Parse Stringified JSON
								</label>
								<div class="example">
									<code>{"meta": "{\"plan\":\"pro\"}"}</code> → <code>{"meta": {"plan": "pro"}}</code>
									<small>Detects and parses JSON strings within properties, handles escaped
										JSON</small>
								</div>
							</div>

							<div class="processing-option">
								<label class="checkbox-label">
									<input type="checkbox"
										id="dedupe"
										name="dedupe">
									Deduplicate Records
								</label>
								<div class="example">
									<span class="muted-text">Same record × 3</span> → <span class="success-text">✓ 1
										unique record</span>
									<small>Uses MurmurHash v3 to detect and skip identical records across entire
										dataset</small>
								</div>
							</div>
						</div>

						<div class="form-row">
							<div class="form-group">
								<label for="timeOffset">Time Offset (hours)</label>
								<input type="number"
									id="timeOffset"
									name="timeOffset"
									value="0"
									step="0.5"
									autocomplete="off">
								<small>Add/subtract hours from timestamps (e.g., -8 for PST to UTC)</small>
							</div>
							<div class="form-group">
								<label for="insertIdTuple">Insert ID Columns</label>
								<input type="text"
									id="insertIdTuple"
									name="insertIdTuple"
									placeholder="user_id,event"
									autocomplete="off">
								<small>Generate $insert_id from these columns (prevents duplicates)</small>
							</div>
						</div>
					</div>
				</div>

				<!-- Filtering & Lists -->
				<div class="collapsible-section">
					<div class="section-header"
						onclick="toggleSection('filtering-section')"
						title="Filter events and properties using whitelists, blacklists, and property removal rules">
						<span class="section-icon">🔍</span>
						<h3>Filtering & Lists</h3>
						<span class="toggle-icon">▼</span>
					</div>
					<div id="filtering-section"
						class="collapsible-content"
						style="display: none;">
						<div class="form-row">
							<div class="form-group">
								<label for="eventWhitelist">Event Whitelist</label>
								<input type="text"
									id="eventWhitelist"
									name="eventWhitelist"
									placeholder="event1,event2"
									autocomplete="off">
								<small>Only import these events (comma-separated)</small>
							</div>
							<div class="form-group">
								<label for="eventBlacklist">Event Blacklist</label>
								<input type="text"
									id="eventBlacklist"
									name="eventBlacklist"
									placeholder="spam_event,test_event"
									autocomplete="off">
								<small>Skip these events (comma-separated)</small>
							</div>
						</div>

						<div class="form-row">
							<div class="form-group">
								<label for="propKeyWhitelist">Property Key Whitelist</label>
								<input type="text"
									id="propKeyWhitelist"
									name="propKeyWhitelist"
									placeholder="user_id,plan"
									autocomplete="off">
								<small>Only events with these property keys</small>
							</div>
							<div class="form-group">
								<label for="propKeyBlacklist">Property Key Blacklist</label>
								<input type="text"
									id="propKeyBlacklist"
									name="propKeyBlacklist"
									placeholder="pii_field,secret"
									autocomplete="off">
								<small>Skip events with these property keys</small>
							</div>
						</div>

						<div class="form-row">
							<div class="form-group">
								<label for="propValWhitelist">Property Value Whitelist</label>
								<input type="text"
									id="propValWhitelist"
									name="propValWhitelist"
									placeholder="premium,enterprise">
								<small>Only events with these property values</small>
							</div>
							<div class="form-group">
								<label for="propValBlacklist">Property Value Blacklist</label>
								<input type="text"
									id="propValBlacklist"
									name="propValBlacklist"
									placeholder="test,internal">
								<small>Skip events with these property values</small>
							</div>
						</div>

						<div class="form-row">
							<div class="form-group">
								<label for="scrubProps">Properties to Remove</label>
								<input type="text"
									id="scrubProps"
									name="scrubProps"
									placeholder="password,ssn,email"
									autocomplete="off">
								<small>Remove these properties from all records</small>
							</div>
							<div class="form-group">
								<label for="aliases">Property Aliases (JSON)</label>
								<input type="text"
									id="aliases"
									name="aliases"
									placeholder='{"old_name":"new_name"}'>
								<small>Rename properties: {"oldKey":"newKey"}</small>
							</div>
						</div>
					</div>
				</div>

				<!-- Time & Date Filters -->
				<div class="collapsible-section">
					<div class="section-header"
						onclick="toggleSection('time-section')"
						title="Filter data by timestamp ranges for imports and exports">
						<span class="section-icon">📅</span>
						<h3>Time & Date Filters</h3>
						<span class="toggle-icon">▼</span>
					</div>
					<div id="time-section"
						class="collapsible-content"
						style="display: none;">
						<div class="form-row">
							<div class="form-group">
								<label for="epochStart">Start Timestamp (Unix)</label>
								<input type="number"
									id="epochStart"
									name="epochStart"
									placeholder="1609459200"
									autocomplete="off">
								<small>Skip data before this Unix timestamp</small>
							</div>
							<div class="form-group">
								<label for="epochEnd">End Timestamp (Unix)</label>
								<input type="number"
									id="epochEnd"
									name="epochEnd"
									placeholder="1609459200"
									autocomplete="off">
								<small>Skip data after this Unix timestamp</small>
							</div>
						</div>

					</div>
				</div>

				<!-- Output & File Options -->
				<div class="collapsible-section">
					<div class="section-header"
						onclick="toggleSection('output-section')"
						title="Control logging, file output, progress display, and result storage options">
						<span class="section-icon">💾</span>
						<h3>Output & File Options</h3>
						<span class="toggle-icon">▼</span>
					</div>
					<div id="output-section"
						class="collapsible-content"
						style="display: none;">
						<div class="checkbox-grid">
							<label class="checkbox-label">
								<input type="checkbox"
									id="logs"
									name="logs">
								Save Import Logs
							</label>
							<label class="checkbox-label">
								<input type="checkbox"
									id="verbose"
									name="verbose">
								Verbose Console Output
							</label>
							<label class="checkbox-label">
								<input type="checkbox"
									id="showProgress"
									name="showProgress" checked>
								Show Progress Bar
							</label>
							<label class="checkbox-label">
								<input type="checkbox"
									id="writeToFile"
									name="writeToFile">
								Write to Local File
							</label>
						</div>

						<div class="form-row">
							<div class="form-group">
								<label for="where">Output Directory</label>
								<input type="text"
									id="where"
									name="where"
									placeholder="./logs">
								<small>Directory for logs and exported files</small>
							</div>
							<div class="form-group">
								<label for="outputFilePath">Output File Path</label>
								<input type="text"
									id="outputFilePath"
									name="outputFilePath"
									placeholder="./output.json">
								<small>Path for transformed data output</small>
							</div>
						</div>
					</div>
				</div>

				<!-- Advanced Expert Settings -->
				<div class="collapsible-section">
					<div class="section-header"
						onclick="toggleSection('expert-section')"
						title="Advanced options for power users including tags, vendor options, and low-level settings">
						<span class="section-icon">🔬</span>
						<h3>Expert Settings</h3>
						<span class="toggle-icon">▼</span>
					</div>
					<div id="expert-section"
						class="collapsible-content"
						style="display: none;">
						<div class="form-row">
							<div class="form-group">
								<label for="tags">Global Tags (JSON)</label>
								<input type="text"
									id="tags"
									name="tags"
									placeholder='{"source":"import","version":"1.0"}'>
								<small>Tags added to all records: {"key":"value"}</small>
							</div>
							<div class="form-group">
								<label for="vendorOpts">Vendor Options (JSON)</label>
								<input type="text"
									id="vendorOpts"
									name="vendorOpts"
									placeholder='{"user_id":"uuid"}'>
								<small>Vendor-specific transform options</small>
							</div>
						</div>


						<div class="checkbox-grid">
							<label class="checkbox-label">
								<input type="checkbox"
									id="forceStream"
									name="forceStream"
									checked>
								Force Stream Mode
							</label>
							<label class="checkbox-label">
								<input type="checkbox"
									id="abridged"
									name="abridged">
								Abridged Responses
							</label>
							<label class="checkbox-label">
								<input type="checkbox"
									id="http2"
									name="http2">
								Use HTTP/2
							</label>
							<label class="checkbox-label">
								<input type="checkbox"
									id="keepBadRecords"
									name="keepBadRecords">
								Keep Bad Records
							</label>
						</div>
					</div>
				</div>
			</section>

			<!-- Transform Section -->
			<section class="card">
				<h2 class="section-title">🔧 Data Transform (Optional)</h2>
				<p class="section-description">Write custom JavaScript to transform your data before importing. Use the
					preview to test your changes.</p>

				<div class="transform-editor">
					<div id="monaco-editor"
						class="code-editor"></div>
					<div class="editor-help">
						<p><strong>Available parameters:</strong></p>
						<ul>
							<li><code>row</code> - The current record object to transform</li>
						</ul>
						<p><strong>Examples:</strong> Add properties, rename fields, skip records (return {}), or split
							into multiple records (return array)</p>
					</div>
				</div>

				<div class="transform-actions">
					<button type="button"
						id="clear-transform"
						class="btn btn-ghost">Reset to Default</button>
				</div>

				<div id="preview-results"
					class="preview-section"
					style="display: none;">
					<h3>Transform Preview</h3>
					<div id="preview-content"
						class="preview-content"></div>
				</div>
			</section>

			<!-- CLI Command Preview -->
			<section class="card">
				<h2 class="section-title">💻 Equivalent CLI Command</h2>
				<p class="section-description">Copy this command to run the same import from your terminal.</p>

				<div class="cli-preview">
					<div class="cli-header">
						<span class="cli-label">Terminal Command:</span>
						<button type="button"
							id="copy-cli"
							class="btn btn-ghost btn-sm">
							<span class="btn-icon">📋</span>
							Copy
						</button>
					</div>
					<pre id="cli-command"
						class="cli-command">Select options above to generate CLI command...</pre>
				</div>
			</section>

			<!-- Actions -->
			<section class="actions">
				<button type="button"
					id="dry-run-btn"
					class="btn btn-secondary">
					<span class="btn-icon">🧪</span>
					Test Run (Dry Run)
				</button>
				<button type="submit"
					id="import-btn"
					class="btn btn-primary">
					<span class="btn-icon">🚀</span>
					Start Import
				</button>
			</section>

			<!-- Loading State -->
			<div id="loading"
				class="loading-overlay"
				style="display: none;">
				<div class="loading-content">
					<div class="loading-spinner"></div>
					<h3 id="loading-title">Processing...</h3>
					<p id="loading-message">Importing your data to Mixpanel</p>
				</div>
			</div>

			<!-- Results -->
			<div id="results"
				class="results-section"
				style="display: none;">
				<div class="results-content">
					<h3 id="results-title">Import Complete!</h3>
					<div id="results-data"
						class="results-data"></div>
				</div>
			</div>
		</form>
	</div>

	<script src="import.js"></script>
</body>

</html>